<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>M√¥ Ph·ªèng K·ªπ S∆∞ Ma S√°t - V·∫≠t L√≠ 10</title>
    <style>
        :root {
            --primary: #2980b9;
            --success: #27ae60;
            --warning: #f39c12;
            --bg: #ecf0f1;
            --tool-bg: #fff;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--bg);
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            height: 100vh;
            overflow: hidden;
        }

        /* HEADER & ENGINEER INFO */
        header {
            width: 100%;
            max-width: 800px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: white;
            padding: 15px;
            border-radius: 10px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }

        .engineer-profile {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .avatar {
            width: 60px;
            height: 60px;
            background: #dfe6e9;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            border: 2px solid var(--primary);
            font-size: 30px;
        }

        .score-board {
            text-align: right;
        }

        /* GAME AREA */
        #game-stage {
            width: 100%;
            max-width: 800px;
            height: 350px;
            background: white;
            border-radius: 15px;
            border: 3px dashed #bdc3c7;
            position: relative;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            transition: all 0.3s;
        }

        #game-stage.drag-over {
            border-color: var(--success);
            background-color: #e8f8f5;
        }

        .scenario-title {
            position: absolute;
            top: 20px;
            font-size: 1.2rem;
            font-weight: bold;
            color: #2c3e50;
            background: rgba(255,255,255,0.9);
            padding: 5px 15px;
            border-radius: 20px;
            z-index: 10;
        }

        /* SCENE ELEMENTS (CSS DRAWINGS) */
        .scene-object {
            font-size: 100px; /* Emoji size */
            transition: transform 0.3s;
            cursor: pointer;
            filter: drop-shadow(0 5px 5px rgba(0,0,0,0.2));
        }
        
        /* Animation cho c√°c t√¨nh hu·ªëng */
        @keyframes shake {
            0% { transform: translate(1px, 1px) rotate(0deg); }
            10% { transform: translate(-1px, -2px) rotate(-1deg); }
            20% { transform: translate(-3px, 0px) rotate(1deg); }
            30% { transform: translate(3px, 2px) rotate(0deg); }
            40% { transform: translate(1px, -1px) rotate(1deg); }
            50% { transform: translate(-1px, 2px) rotate(-1deg); }
            60% { transform: translate(-3px, 1px) rotate(0deg); }
            70% { transform: translate(3px, 1px) rotate(-1deg); }
            80% { transform: translate(-1px, -1px) rotate(1deg); }
            90% { transform: translate(1px, 2px) rotate(0deg); }
            100% { transform: translate(1px, -2px) rotate(-1deg); }
        }
        
        .needs-fixing {
            animation: shake 0.5s;
            animation-iteration-count: infinite;
        }

        .status-indicator {
            margin-top: 10px;
            color: #e74c3c;
            font-weight: bold;
            font-style: italic;
        }

        /* TOOLBOX */
        .toolbox {
            margin-top: 20px;
            display: flex;
            gap: 20px;
            padding: 15px;
            background: rgba(255, 255, 255, 0.5);
            border-radius: 15px;
        }

        .tool {
            width: 80px;
            height: 80px;
            background: var(--tool-bg);
            border: 2px solid #bdc3c7;
            border-radius: 10px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            cursor: grab;
            transition: transform 0.2s, box-shadow 0.2s;
            user-select: none;
        }

        .tool:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            border-color: var(--primary);
        }

        .tool:active { cursor: grabbing; }

        .tool-icon { font-size: 35px; margin-bottom: 5px; }
        .tool-name { font-size: 12px; font-weight: bold; color: #555; text-align: center; }

        /* MODAL FEEDBACK */
        #feedback-modal {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.7);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 100;
        }

        .modal-content {
            background: white;
            padding: 30px;
            border-radius: 15px;
            width: 500px;
            text-align: center;
            box-shadow: 0 10px 25px rgba(0,0,0,0.2);
            animation: popIn 0.3s ease-out;
        }

        @keyframes popIn {
            from { transform: scale(0.8); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }

        .btn-next {
            background: var(--primary);
            color: white;
            border: none;
            padding: 10px 25px;
            border-radius: 5px;
            font-size: 1rem;
            cursor: pointer;
            margin-top: 15px;
        }
        .btn-next:hover { background: #2980b9; }

        /* PH·∫¶N GI·∫¢I TH√çCH V·∫¨T L√ù */
        .physics-note {
            background: #eaf2f8;
            padding: 10px;
            margin-top: 15px;
            border-left: 4px solid var(--primary);
            text-align: left;
            font-size: 0.95rem;
        }

        /* ·∫®n hi·ªán tool */
        .hidden { display: none !important; }

    </style>
</head>
<body>

    <header>
        <div class="engineer-profile">
            <div class="avatar">üë∑</div>
            <div>
                <h2 style="margin:0">K·ªπ S∆∞ S·ª≠a Ch·ªØa</h2>
                <small>Nhi·ªám v·ª•: ·ª®ng d·ª•ng L·ª±c Ma S√°t</small>
            </div>
        </div>
        <div class="score-board">
            <div>M√†n: <span id="level-display">1</span>/3</div>
            <div style="font-size: 0.9rem; color: #7f8c8d;">K√©o d·ª•ng c·ª• v√†o v√πng gi·ªØa</div>
        </div>
    </header>

    <div id="game-stage" ondrop="drop(event)" ondragover="allowDrop(event)">
        <div id="scenario-title" class="scenario-title">ƒêang t·∫£i...</div>
        
        <div id="target-object" class="scene-object"></div>
        
        <div id="status-text" class="status-indicator"></div>
    </div>

    <div class="toolbox">
        <div class="tool" draggable="true" ondragstart="drag(event)" id="tool-oil" data-type="oil">
            <div class="tool-icon">üõ¢Ô∏è</div>
            <div class="tool-name">D·∫ßu Nh·ªõt</div>
        </div>
        
        <div class="tool" draggable="true" ondragstart="drag(event)" id="tool-sand" data-type="sand">
            <div class="tool-icon">üèúÔ∏è</div>
            <div class="tool-name">C√°t/ƒê√°</div>
        </div>
        
        <div class="tool" draggable="true" ondragstart="drag(event)" id="tool-roller" data-type="roller">
            <div class="tool-icon">üõπ</div>
            <div class="tool-name">Con LƒÉn</div>
        </div>

        <div class="tool" draggable="true" ondragstart="drag(event)" id="tool-hammer" data-type="wrong">
            <div class="tool-icon">üî®</div>
            <div class="tool-name">B√∫a</div>
        </div>
    </div>

    <div id="feedback-modal">
        <div class="modal-content">
            <h2 id="modal-title">K·∫øt Qu·∫£</h2>
            <div id="modal-message"></div>
            <div id="physics-explanation" class="physics-note"></div>
            <button class="btn-next" onclick="nextLevel()">Ti·∫øp t·ª•c</button>
        </div>
    </div>

    <script>
        // C·∫§U H√åNH D·ªÆ LI·ªÜU C√ÅC M√ÄN CH∆†I
        const scenarios = [
            {
                id: 1,
                title: "T√¨nh hu·ªëng 1: X√≠ch xe ƒë·∫°p b·ªã r·ªâ s√©t, k√™u r√≠t",
                objectIcon: "üö≤",
                statusText: "√Çm thanh: K√âT... K√âT... (Ma s√°t qu√° l·ªõn)",
                correctTool: "oil",
                animationClass: "needs-fixing",
                successMsg: "Tuy·ªát v·ªùi! Xe ch·∫°y √™m ru.",
                explanation: "<strong>T·∫°i sao?</strong> D·∫ßu nh·ªõt t·∫°o ra m·ªôt l·ªõp m√†ng ngƒÉn c√°ch gi·ªØa c√°c b·ªÅ m·∫∑t kim lo·∫°i c·ªßa x√≠ch v√† l√≠p. N√≥ chuy·ªÉn ma s√°t tr∆∞·ª£t kh√¥ th√†nh ma s√°t ∆∞·ªõt (nh·ªõt), l√†m <strong>gi·∫£m h·ªá s·ªë ma s√°t</strong> ƒë√°ng k·ªÉ."
            },
            {
                id: 2,
                title: "T√¨nh hu·ªëng 2: ƒê∆∞·ªùng tr∆°n tr∆∞·ª£t sau m∆∞a",
                objectIcon: "üõ£Ô∏è",
                statusText: "Nguy hi·ªÉm! Xe d·ªÖ b·ªã tr∆∞·ª£t ng√£ (Ma s√°t qu√° nh·ªè)",
                correctTool: "sand",
                animationClass: "", // Kh√¥ng rung, ch·ªâ hi·ªÉn th·ªã tƒ©nh
                successMsg: "ƒê√£ x·ª≠ l√Ω! ƒê∆∞·ªùng b√°m t·ªët h∆°n.",
                explanation: "<strong>T·∫°i sao?</strong> R·∫Øc c√°t ho·∫∑c ƒë√° dƒÉm gi√∫p tƒÉng ƒë·ªô nh√°m c·ªßa b·ªÅ m·∫∑t ƒë∆∞·ªùng. Vi·ªác n√†y l√†m <strong>tƒÉng l·ª±c ma s√°t ngh·ªâ</strong> v√† ma s√°t tr∆∞·ª£t, gi√∫p l·ªëp xe b√°m ƒë∆∞·ªùng t·ªët h∆°n, tr√°nh tai n·∫°n."
            },
            {
                id: 3,
                title: "T√¨nh hu·ªëng 3: Di chuy·ªÉn t·ªß g·ªó r·∫•t n·∫∑ng",
                objectIcon: "üì¶", // D√πng icon box ƒë·∫°i di·ªán t·ªß
                statusText: "N·∫∑ng qu√°! ƒê·∫©y kh√¥ng nh√∫c nh√≠ch.",
                correctTool: "roller",
                animationClass: "",
                successMsg: "Th√¥ng minh! ƒê·∫©y nh·∫π nh√†ng.",
                explanation: "<strong>T·∫°i sao?</strong> Khi ƒë·∫∑t con lƒÉn xu·ªëng d∆∞·ªõi, ta ƒë√£ chuy·ªÉn t·ª´ ma s√°t tr∆∞·ª£t sang <strong>ma s√°t lƒÉn</strong>. L·ª±c ma s√°t lƒÉn c√≥ ƒë·ªô l·ªõn nh·ªè h∆°n r·∫•t nhi·ªÅu so v·ªõi ma s√°t tr∆∞·ª£t, gi√∫p di chuy·ªÉn v·∫≠t n·∫∑ng d·ªÖ d√†ng."
            }
        ];

        let currentLevel = 0;
        const stage = document.getElementById('game-stage');
        const titleEl = document.getElementById('scenario-title');
        const objectEl = document.getElementById('target-object');
        const statusEl = document.getElementById('status-text');
        const modal = document.getElementById('feedback-modal');

        // KH·ªûI T·∫†O
        function initGame() {
            loadLevel(0);
        }

        function loadLevel(index) {
            if (index >= scenarios.length) {
                finishGame();
                return;
            }
            
            const data = scenarios[index];
            document.getElementById('level-display').innerText = index + 1;
            
            titleEl.innerText = data.title;
            objectEl.innerText = data.objectIcon;
            statusEl.innerText = data.statusText;
            
            // Reset animation
            objectEl.className = "scene-object " + (data.animationClass || "");
            objectEl.style.transform = "none";
        }

        // DRAG & DROP LOGIC
        function allowDrop(ev) {
            ev.preventDefault();
            stage.classList.add('drag-over');
        }

        function drag(ev) {
            // G·ª≠i ID lo·∫°i d·ª•ng c·ª•
            ev.dataTransfer.setData("toolType", ev.target.getAttribute('data-type'));
            stage.classList.remove('drag-over');
        }

        /* X·ª≠ l√Ω khi k√©o ra ngo√†i v√πng th·∫£ ƒë·ªÉ t·∫Øt hi·ªáu ·ª©ng border */
        stage.addEventListener('dragleave', () => {
            stage.classList.remove('drag-over');
        });

        function drop(ev) {
            ev.preventDefault();
            stage.classList.remove('drag-over');
            
            const toolType = ev.dataTransfer.getData("toolType");
            checkResult(toolType);
        }

        // KI·ªÇM TRA K·∫æT QU·∫¢
        function checkResult(toolType) {
            const currentData = scenarios[currentLevel];

            if (toolType === currentData.correctTool) {
                // ƒê√öNG
                showFeedback(true, currentData);
            } else {
                // SAI
                showFeedback(false, null);
            }
        }

        function showFeedback(isSuccess, data) {
            modal.style.display = "flex";
            const mTitle = document.getElementById('modal-title');
            const mMsg = document.getElementById('modal-message');
            const mExp = document.getElementById('physics-explanation');
            const btn = document.querySelector('.btn-next');

            if (isSuccess) {
                mTitle.innerText = "CH√çNH X√ÅC! üéâ";
                mTitle.style.color = "#27ae60";
                mMsg.innerText = data.successMsg;
                mExp.innerHTML = data.explanation;
                mExp.style.display = "block";
                
                // Hi·ªáu ·ª©ng tr√™n m√†n h√¨nh game
                objectEl.className = "scene-object"; // B·ªè rung l·∫Øc
                objectEl.style.transform = "scale(1.2)"; // Ph√≥ng to nh·∫π b√°o hi·ªáu th√†nh c√¥ng
                statusEl.innerText = "ƒê√£ kh·∫Øc ph·ª•c xong!";
                statusEl.style.color = "#27ae60";

                btn.innerText = "M√†n ti·∫øp theo";
                btn.onclick = nextLevel;
            } else {
                mTitle.innerText = "CH∆ØA ƒê√öNG! üòÖ";
                mTitle.style.color = "#c0392b";
                mMsg.innerText = "D·ª•ng c·ª• n√†y kh√¥ng ph√π h·ª£p v·ªõi t√¨nh hu·ªëng. H√£y th·ª≠ l·∫°i xem!";
                mExp.style.display = "none";
                
                btn.innerText = "Th·ª≠ l·∫°i";
                btn.onclick = closeModal;
            }
        }

        function closeModal() {
            modal.style.display = "none";
        }

        function nextLevel() {
            closeModal();
            currentLevel++;
            loadLevel(currentLevel);
        }

        function finishGame() {
            stage.innerHTML = "<h1>üèÜ CH√öC M·ª™NG!</h1><p>B·∫°n ƒë√£ ho√†n th√†nh xu·∫•t s·∫Øc kh√≥a hu·∫•n luy·ªán K·ªπ S∆∞ Ma S√°t.</p>";
            document.querySelector('.toolbox').style.display = 'none';
        }

        // Ch·∫°y game
        initGame();

    </script>
</body>
</html>